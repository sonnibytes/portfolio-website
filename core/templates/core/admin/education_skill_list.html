{% extends "admin/admin_base.html" %}
{% load static %}

{% block admin_title %}{{ title }} - AURA Admin{% endblock %}

{% block extra_css %}
<style>
.skill-development-card {
    background: linear-gradient(135deg, rgba(139, 69, 19, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    border: 1px solid rgba(139, 69, 19, 0.3);
    border-radius: 0.75rem;
    padding: 1.5rem;
    transition: all 0.3s ease;
}

.skill-development-card:hover {
    transform: translateY(-2px);
    border-color: rgba(139, 69, 19, 0.5);
    box-shadow: 0 8px 32px rgba(139, 69, 19, 0.2);
}

.proficiency-progress {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 0.5rem;
    border-left: 4px solid;
}

.proficiency-major { border-left-color: #4CAF50; }
.proficiency-good { border-left-color: #2196F3; }
.proficiency-some { border-left-color: #FF9800; }
.proficiency-minimal { border-left-color: #9E9E9E; }

.proficiency-bar {
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
    flex: 1;
    position: relative;
}

.proficiency-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.8s ease;
}

.proficiency-before {
    background: rgba(255, 255, 255, 0.3);
    position: absolute;
    left: 0;
    top: 0;
}

.proficiency-after {
    background: linear-gradient(90deg, #4CAF50, #8BC34A);
    position: absolute;
    left: 0;
    top: 0;
}

.learning-focus-badge {
    background: rgba(255, 255, 255, 0.1);
    color: #E8EAF6;
    padding: 0.25rem 0.75rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    text-transform: capitalize;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.importance-indicator {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.importance-star {
    color: #FFD700;
    font-size: 0.875rem;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.stat-card {
    background: linear-gradient(135deg, rgba(139, 69, 19, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    border: 1px solid rgba(139, 69, 19, 0.3);
    border-radius: 0.75rem;
    padding: 1.5rem;
    text-align: center;
}

.stat-value {
    font-size: 2rem;
    font-weight: 700;
    color: #D2691E;
    margin-bottom: 0.5rem;
}

.stat-label {
    color: #B0BEC5;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
}
</style>
{% endblock %}

{% block admin_content %}
<div class="space-y-8">
    
    <!-- Header Section -->
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-3xl font-bold text-white mb-2 flex items-center">
                <i class="fas fa-graduation-cap text-yellow-400 mr-3"></i>
                {{ title }}
            </h1>
            <p class="text-gray-400">{{ subtitle }}</p>
        </div>
        <a href="{% url 'aura_admin:education_skill_create' %}" class="btn btn-primary">
            <i class="fas fa-plus mr-2"></i>
            Add Skill Development
        </a>
    </div>

    <!-- Statistics Overview -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value">{{ skill_developments.count }}</div>
            <div class="stat-label">Total Connections</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">
                {% with major_improvements=skill_developments|length %}
                    {{ skill_developments|length }}
                {% endwith %}
            </div>
            <div class="stat-label">Skills Developed</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">
                {% regroup skill_developments by education as education_groups %}
                {{ education_groups|length }}
            </div>
            <div class="stat-label">Education Entries</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">
                {% for dev in skill_developments %}
                    {% if dev.get_skill_improvement >= 3 %}1{% endif %}
                {% empty %}0{% endfor %}
            </div>
            <div class="stat-label">Major Improvements</div>
        </div>
    </div>

    <!-- Skill Developments Grid -->
    <div class="space-y-6">
        {% regroup skill_developments by education as education_groups %}
        {% for education_group in education_groups %}
            <div class="glass-card p-6">
                <div class="flex items-center justify-between mb-6">
                    <div>
                        <h2 class="text-xl font-bold text-white flex items-center">
                            <i class="fas fa-university text-yellow-400 mr-3"></i>
                            {{ education_group.grouper.degree }}
                        </h2>
                        <p class="text-gray-400">{{ education_group.grouper.institution }} • {{ education_group.grouper.get_learning_type_display }}</p>
                    </div>
                    <div class="text-sm text-gray-400">
                        {{ education_group.list|length }} skill{{ education_group.list|length|pluralize }} developed
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    {% for skill_dev in education_group.list %}
                        <div class="skill-development-card">
                            <div class="flex items-start justify-between mb-4">
                                <div class="flex-1">
                                    <h3 class="text-lg font-bold text-white mb-1">{{ skill_dev.skill.name }}</h3>
                                    <p class="text-sm text-gray-400">{{ skill_dev.skill.get_category_display }}</p>
                                </div>
                                <div class="learning-focus-badge">
                                    {{ skill_dev.get_learning_focus_display }}
                                </div>
                            </div>
                            
                            <div class="proficiency-progress proficiency-{% if skill_dev.get_skill_improvement >= 3 %}major{% elif skill_dev.get_skill_improvement >= 2 %}good{% elif skill_dev.get_skill_improvement >= 1 %}some{% else %}minimal{% endif %} mb-4">
                                <div class="text-sm text-white font-medium">
                                    {{ skill_dev.proficiency_before }} → {{ skill_dev.proficiency_after }}
                                </div>
                                <div class="proficiency-bar">
                                    <div class="proficiency-before" style="width: {{ skill_dev.proficiency_before|floatformat:0 }}0%;"></div>
                                    <div class="proficiency-after" style="width: {{ skill_dev.proficiency_after|floatformat:0 }}0%;"></div>
                                </div>
                                <div class="text-sm font-medium" style="color: {{ skill_dev.get_improvement_color }};">
                                    +{{ skill_dev.get_skill_improvement }}
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between mb-3">
                                <div class="importance-indicator">
                                    <span class="text-gray-400 text-sm">Importance:</span>
                                    {% for i in "12345" %}
                                        {% if forloop.counter <= skill_dev.importance_level %}
                                            <i class="fas fa-star importance-star"></i>
                                        {% else %}
                                            <i class="far fa-star importance-star" style="color: #546E7A;"></i>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                            
                            {% if skill_dev.learning_notes %}
                                <p class="text-sm text-gray-300 mb-4 border-l-2 border-yellow-400 pl-3">
                                    {{ skill_dev.learning_notes|truncatewords:20 }}
                                </p>
                            {% endif %}
                            
                            <div class="flex items-center justify-between">
                                <div class="flex space-x-2">
                                    <a href="{% url 'aura_admin:education_skill_update' skill_dev.pk %}" 
                                       class="btn btn-sm btn-secondary">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <a href="{% url 'aura_admin:education_skill_delete' skill_dev.pk %}" 
                                       class="btn btn-sm btn-danger">
                                        <i class="fas fa-trash"></i>
                                    </a>
                                </div>
                                
                                <div class="text-xs text-gray-400">
                                    {% if skill_dev.get_skill_improvement >= 3 %}
                                        Major Improvement
                                    {% elif skill_dev.get_skill_improvement >= 2 %}
                                        Good Progress
                                    {% elif skill_dev.get_skill_improvement >= 1 %}
                                        Some Progress
                                    {% else %}
                                        Review/Refresh
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% empty %}
            <div class="glass-card p-12 text-center">
                <i class="fas fa-graduation-cap text-6xl text-gray-600 mb-4"></i>
                <h3 class="text-xl text-gray-400 mb-2">No Skill Developments Found</h3>
                <p class="text-gray-500 mb-6">Start tracking how your education develops your skills.</p>
                <a href="{% url 'aura_admin:education_skill_create' %}" class="btn btn-primary">
                    <i class="fas fa-plus mr-2"></i>Add First Skill Development
                </a>
            </div>
        {% endfor %}
    </div>

</div>
{% endblock %}